#include "locations.h"
#include <vector>
#include <Security/xorstr.hpp>
#include "Includes/CustomWidgets/Notify.hpp"

std::vector<Features::Locations::coordinates> Features::Locations::LoadCoords() {
    return vEntries;  
}

void Features::Locations::SaveCoords(const std::string& name, float x, float y, float z) {
    for (const auto& entry : Features::g_Locations->vEntries) {
        if (entry.name == name) {
            NotifyManager::Send(xorstr( "The current name already exists. Please use another one." ), 4000);
            return;
        }
    }

    vEntries.push_back({ name, x, y, z });
    NotifyManager::Send(xorstr( "Successfully Saved!" ), 4000);
}

void Features::Locations::SaveCoordsAndReLoad(const std::string& name, float x, float y, float z) {
    SaveCoords(name, x, y, z);
    vEntries = Features::g_Locations->LoadCoords();
}

void Features::Locations::DeleteCoords(const std::string& name) {
    auto it = std::remove_if(vEntries.begin(), vEntries.end(),
        [&name](const coordinates& entry) { return entry.name == name; });
    if (it != vEntries.end()) {
        vEntries.erase(it, vEntries.end());
        NotifyManager::Send(xorstr(  "Successfully Deleted!"  ), 4000);
    }
    else {
        //FrameWork::g_Notifications->Add(skCrypt("Faild to Delete!").Decrypt());
    }
}

void Features::Locations::DeleteCoordsAndReLoad(const std::string& name) {
    DeleteCoords(name);
    vEntries = LoadCoords();
}